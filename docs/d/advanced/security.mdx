---
title: Security Best Practices
---

# Techniques: Security Best Practices in Nanoservice-ts

Security is paramount in any application, and Nanoservice-ts applications are no exception. While the framework provides a structure for building modular services, developers are responsible for implementing security measures at various levels. This guide outlines key security best practices to consider when developing with Nanoservice-ts.

## 1. Input Validation and Sanitization

Never trust external input. Malicious inputs can lead to various attacks, including Injection (SQL, NoSQL, Command), Cross-Site Scripting (XSS) if outputs are rendered in a web context, and Denial of Service (DoS).

-   **Schema Validation:** Rigorously use `inputSchema` in your Node `package.json` files to validate the structure, type, and format of all incoming data. See [Techniques: Validation](./validation.mdx).
-   **Custom Validation:** For business logic specific validation, implement checks within your Node's `handle` method.
-   **Sanitization:** If input data is used to construct queries (especially SQL, NoSQL, or shell commands), always use parameterized queries or ORM/ODM features that handle sanitization. For data that will be rendered in HTML, ensure proper output encoding to prevent XSS.
-   **Rate Limiting:** Implement rate limiting on public-facing triggers (especially HTTP APIs) to prevent abuse and DoS attacks. This might be handled at an API gateway level or using middleware if Nanoservice-ts is exposed directly.

## 2. Authentication and Authorization

Protect your workflows and nodes from unauthorized access.

-   **Authentication:** Verify the identity of users or services trying to access your Nanoservice-ts application.
    -   For HTTP triggers, use standard mechanisms like API Keys, JWT (JSON Web Tokens), OAuth 2.0, or Basic Auth, typically handled by dedicated authentication Nodes or middleware before the main workflow logic.
    -   Ensure secure storage and transmission of credentials.
-   **Authorization:** Once authenticated, verify if the user/service has the necessary permissions to perform the requested action or access the requested data.
    -   Implement role-based access control (RBAC) or attribute-based access control (ABAC) logic within your workflows or dedicated authorization Nodes.
    -   Check permissions before executing sensitive operations or returning sensitive data.

**Example (Conceptual Auth Node):**

A workflow might start with an `auth-node` that validates a token from the HTTP trigger's headers. If invalid, the node returns an error, and the workflow stops.

## 3. Secure Configuration Management

-   **Secrets Management:** Never hardcode secrets (API keys, database passwords, encryption keys) directly in your code or workflow JSON files.
    -   Use environment variables (`process.env.SECRET_KEY`) and access them in workflow inputs using `{{env.SECRET_KEY}}`.
    -   For production, use a dedicated secrets management service (e.g., HashiCorp Vault, AWS Secrets Manager, Azure Key Vault) and integrate it with your deployment environment.
-   **Least Privilege for Configuration:** Ensure that configuration files and environment variables are only accessible by the Nanoservice-ts application process with the minimum necessary permissions.

## 4. Protecting Data

-   **Data in Transit:** Use HTTPS (TLS/SSL) for all external communication, especially for HTTP triggers and when Nodes make calls to external APIs. Ensure your Nanoservice-ts application server is configured to use HTTPS.
-   **Data at Rest:** If your Nodes store sensitive data in databases or files, ensure that data is encrypted at rest using industry-standard encryption algorithms.
-   **Minimize Data Exposure:** Nodes should only request and return the data they absolutely need. Avoid logging sensitive data unless strictly necessary and properly masked/secured (see [Techniques: Logging](./logging.mdx)).

## 5. Secure Node Development

-   **Principle of Least Privilege:** Nodes should only have the permissions they need to perform their specific task.
-   **Dependency Security:** Regularly scan your project dependencies (including Node.js, Nanoservice-ts packages, and any third-party libraries) for known vulnerabilities using tools like `npm audit` or Snyk. Keep dependencies updated.
-   **Code Reviews:** Conduct security-focused code reviews for new Nodes and significant changes to existing ones.
-   **Avoid Unsafe Operations:** Be cautious with operations that can introduce vulnerabilities, such as:
    -   `eval()` or similar dynamic code execution functions.
    -   Directly executing shell commands constructed from user input (prefer dedicated, safer Node modules for such tasks if unavoidable).
    -   Deserializing untrusted data without proper validation.

## 6. Workflow Security

-   **Access Control for Workflows:** If different workflows have different sensitivity levels, ensure that triggers are appropriately protected. For example, an internal admin workflow should not be exposed via a public, unauthenticated HTTP trigger.
-   **Data Flow Analysis:** Understand how data flows through your workflows. Ensure sensitive data from one Node is not inadvertently exposed or passed to a Node that doesn't need it or might handle it insecurely.

## 7. Logging and Monitoring for Security

-   **Audit Logs:** Log security-relevant events such as login attempts (successful and failed), authorization failures, significant data access, and administrative actions.
-   **Monitor for Suspicious Activity:** Use your logging and monitoring tools to detect unusual patterns that might indicate a security breach (e.g., a spike in failed login attempts, unexpected error rates from specific Nodes, access from unusual IP addresses).
-   **Alerting:** Set up alerts for critical security events.

## 8. Regular Security Audits and Penetration Testing

-   Periodically conduct security audits of your Nanoservice-ts application and its infrastructure.
-   Consider engaging third-party security professionals for penetration testing, especially for applications handling sensitive data or exposed to the public internet.

## 9. Infrastructure Security

-   **Secure Hosting Environment:** Ensure your Nanoservice-ts application is deployed in a secure environment (e.g., a well-configured VPC, hardened operating systems).
-   **Network Security:** Use firewalls and network segmentation to restrict traffic to and from your application.
-   **Regular Patching:** Keep the underlying operating system, Node.js runtime, and any other server software patched and up-to-date.

## 10. Error Handling

-   **Avoid Leaking Sensitive Information in Errors:** Ensure that error messages returned to clients (e.g., in HTTP responses) do not reveal sensitive internal details, stack traces, or system information that could be exploited. Log detailed errors internally but provide generic error messages externally. See [Techniques: Error Handling](./error-handling.mdx).

Security is an ongoing process, not a one-time task. Continuously review and update your security practices as your Nanoservice-ts application evolves and new threats emerge. Stay informed about common web vulnerabilities (e.g., OWASP Top 10) and how they might apply to your specific architecture.
